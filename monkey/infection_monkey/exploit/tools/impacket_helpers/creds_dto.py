from dataclasses import dataclass
from typing import Iterator, List


@dataclass
class NtlmCreds:
    username: str
    password: str
    domain: str = ''
    lmhash: str = ''
    nthash: str = ''

    @staticmethod
    def build_from_list(cred_list: List[str]):
        '''
        @param cred_list: The list which is returned by Configuration.get_exploit_user_password_or_hash_product
        '''
        return NtlmCreds(username=cred_list[0],
                         password=cred_list[1],
                         lmhash=cred_list[2],
                         nthash=cred_list[3])

    def __iter__(self) -> Iterator[str]:
        return iter((self.username, self.password, self.domain, self.lmhash, self.nthash))
